"""
Скрипт для заполнения данных по объекту "Богучар 2"
"""
import sys
sys.path.insert(0, '.')

from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker
from datetime import datetime
from app import models

# Подключение к БД
engine = create_engine("sqlite:///./database.db", connect_args={"check_same_thread": False})
SessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)
db = SessionLocal()

# Маппинг служб к типам schedule
SERVICE_MAPPING = {
    "HR": "hr",
    "Строительство": "construction",
    "Тех. заказ": "document",
    "Закупки": "procurement"
}

def parse_date(date_str):
    """Парсинг даты в формате DD.MM.YYYY"""
    if not date_str or date_str.strip() == "":
        return None
    try:
        return datetime.strptime(date_str.strip(), "%d.%m.%Y")
    except ValueError:
        return None

def get_or_create_city(name):
    """Получить или создать город"""
    city = db.query(models.City).filter(models.City.name == name).first()
    if not city:
        city = models.City(name=name, description=f"Объект строительства {name}")
        db.add(city)
        db.commit()
        db.refresh(city)
        print(f"Создан город: {name} (ID: {city.id})")
    else:
        print(f"Найден город: {name} (ID: {city.id})")
    return city

# Данные из таблицы пользователя
data = [
    # HR - Подготовительные работы
    ("HR", "Подготовительные работы", "Закрыть вакансию разнорабочего (2 чел)", "01.03.2025", "30.03.2025", "01.03.2025", "30.03.2025"),
    
    # Строительство - Подготовительные работы
    ("Строительство", "Подготовительные работы", "Устройство временных сетей ЭС, вр.подъездных дорог", "16.04.2026", "16.08.2026", "", ""),
    ("Строительство", "Подготовительные работы", "Вынос катодной защиты, вынос кабеля 10кВ", "17.08.2026", "20.09.2026", "", ""),
    
    # Тех. заказ - Разработка котлована
    ("Тех. заказ", "Разработка котлована", "Проверка РД и составление ЛЗВ", "01.03.2025", "12.03.2025", "01.03.2025", "20.03.2025"),
    
    # HR - Разработка котлована
    ("HR", "Разработка котлована", "Закрыть вакансию разнорабочего", "01.04.2025", "07.04.2025", "01.04.2025", "07.04.2025"),
    
    # Закупки - Разработка котлована
    ("Закупки", "Разработка котлована", "Проведение тендера для заключения договора с подрядчиком на выполнение работ", "01.03.2025", "15.03.2025", "01.03.2025", "15.03.2025"),
    
    # Строительство - Разработка котлована
    ("Строительство", "Разработка котлована", "Разработка котлована", "01.03.2025", "31.03.2025", "", ""),
    
    # Тех. заказ - Монтаж сборных ж/б конструкций
    ("Тех. заказ", "Монтаж сборных ж/б конструкций", "Передача РД в тех. Заказ АС-0", "20.03.2025", "04.04.2025", "20.03.2025", "04.04.2025"),
    ("Тех. заказ", "Монтаж сборных ж/б конструкций", "Проверка РД и составление ЛЗВ", "20.03.2025", "18.04.2025", "31.03.2025", "21.04.2025"),
    ("Тех. заказ", "Монтаж сборных ж/б конструкций", "Передача РД ГП", "04.04.2025", "11.04.2025", "04.04.2025", "11.04.2025"),
    
    # HR - Монтаж сборных ж/б конструкций
    ("HR", "Монтаж сборных ж/б конструкций", "Закрыть вакансию разнорабочего", "14.07.2025", "31.08.2025", "14.07.2025", "22.07.2025"),
    
    # Закупки - Монтаж сборных ж/б конструкций
    ("Закупки", "Монтаж сборных ж/б конструкций", "Заявка на материалы", "21.03.2025", "15.04.2025", "21.03.2025", "15.04.2025"),
    ("Закупки", "Монтаж сборных ж/б конструкций", "Поставка материалов", "20.04.2025", "10.07.2025", "20.04.2025", "25.06.2025"),
    
    # Строительство - Монтаж сборных ж/б конструкций
    ("Строительство", "Монтаж сборных ж/б конструкций", "Монтаж ж/б конструкций ниже 0.000", "10.03.2025", "20.03.2025", "10.03.2025", "20.03.2025"),
    
    # Строительство - Перебазировка и монтаж башенных кранов
    ("Строительство", "Перебазировка и монтаж башенных кранов", "Монтаж башенного крана КБ-408", "01.04.2025", "10.05.2025", "15.04.2025", "10.05.2025"),
    ("Строительство", "Перебазировка и монтаж башенных кранов", "Монтаж башенного крана КБ-403", "01.04.2025", "20.06.2025", "18.09.2025", ""),
    
    # Тех. заказ - Каменная кладка
    ("Тех. заказ", "Каменная кладка", "Передача РД в тех. Заказ АР", "05.04.2025", "12.05.2025", "05.04.2025", "20.05.2025"),
    ("Тех. заказ", "Каменная кладка", "Передача РД в тех. Заказ АС-1", "15.04.2025", "20.05.2025", "06.04.2025", "23.05.2025"),
    ("Тех. заказ", "Каменная кладка", "Проверка РД и составление ЛЗВ", "21.05.2025", "17.06.2025", "21.05.2025", "27.06.2025"),
    ("Тех. заказ", "Каменная кладка", "Передача РД ГП", "03.06.2025", "17.06.2025", "08.04.2025", "14.08.2025"),
    
    # Закупки - Каменная кладка
    ("Закупки", "Каменная кладка", "Заявка на материалы", "09.06.2025", "20.02.2026", "09.06.2025", ""),
    ("Закупки", "Каменная кладка", "Поставка материалов", "23.06.2025", "01.03.2026", "15.06.2025", ""),
    
    # Строительство - Каменная кладка
    ("Строительство", "Каменная кладка", "Каменная кладка", "10.05.2025", "20.07.2025", "10.05.2025", "05.08.2025"),
    
    # Тех. заказ - Устройство кровли
    ("Тех. заказ", "Устройство кровли", "Проверка РД и составление ЛЗВ", "01.07.2025", "15.07.2025", "15.07.2025", "21.07.2025"),
    
    # Закупки - Устройство кровли
    ("Закупки", "Устройство кровли", "Проведение тендера для заключения договора с подрядчиком на выполнение работ", "16.02.2026", "16.03.2026", "", ""),
    ("Закупки", "Устройство кровли", "Заявка на материалы", "10.03.2026", "30.04.2026", "", ""),
    ("Закупки", "Устройство кровли", "Поставка материалов", "25.03.2026", "15.05.2026", "", ""),
    
    # Строительство - Устройство кровли
    ("Строительство", "Устройство кровли", "Устройство кровли", "21.06.2025", "20.07.2025", "09.06.2025", "05.08.2025"),
    
    # Тех. заказ - Наружная отделка фасада
    ("Тех. заказ", "Наружная отделка фасада", "Проверка РД и составление ЛЗВ", "20.09.2025", "30.09.2025", "27.10.2025", "01.11.2025"),
    
    # Закупки - Наружная отделка фасада
    ("Закупки", "Наружная отделка фасада", "Заявка на материалы", "02.03.2026", "30.06.2026", "", ""),
    ("Закупки", "Наружная отделка фасада", "Проведение тендера для заключения договора с подрядчиком на выполнение работ", "20.04.2026", "15.05.2026", "", ""),
    ("Закупки", "Наружная отделка фасада", "Поставка материалов", "25.05.2026", "20.07.2026", "", ""),
    
    # Строительство - Наружная отделка фасада
    ("Строительство", "Наружная отделка фасада", "Наружная отделка фасада", "21.07.2025", "20.03.2026", "10.07.2025", ""),
    
    # Тех. заказ - Утепление вентшахт, козырьки, переходные лестницы
    ("Тех. заказ", "Утепление вентшахт, козырьки, переходные лестницы", "Проверка РД и составление ЛЗВ", "01.07.2025", "15.07.2025", "01.07.2025", "07.07.2025"),
    
    # Закупки - Утепление вентшахт, козырьки, переходные лестницы
    ("Закупки", "Утепление вентшахт, козырьки, переходные лестницы", "Заявка на материалы на вентшахты", "01.04.2026", "25.05.2026", "", ""),
    ("Закупки", "Утепление вентшахт, козырьки, переходные лестницы", "Проведение тендера для заключения договора с подрядчиком на выполнение работ", "01.04.2026", "20.04.2026", "", ""),
    ("Закупки", "Утепление вентшахт, козырьки, переходные лестницы", "Поставка материалов на вентшахты", "27.04.2026", "05.06.2026", "", ""),
    
    # Строительство - Утепление вентшахт, козырьки, переходные лестницы
    ("Строительство", "Утепление вентшахт, козырьки, переходные лестницы", "Утепление вентшахт, козырьки, переходные лестницы", "10.07.2025", "20.07.2025", "04.08.2025", "09.08.2025"),
    
    # Тех. заказ - Электромонтажные работы
    ("Тех. заказ", "Электромонтажные работы", "Передача РДа в тех. Заказ ЭЛ", "10.05.2025", "15.05.2025", "15.05.2025", "25.06.2025"),
    ("Тех. заказ", "Электромонтажные работы", "Проверка РД и составление ЛЗВ", "15.05.2025", "29.05.2025", "15.10.2023", "23.10.2025"),
    ("Тех. заказ", "Электромонтажные работы", "Передача РД ГП", "25.05.2025", "10.11.2025", "25.11.2025", "15.12.2025"),
    
    # Закупки - Электромонтажные работы
    ("Закупки", "Электромонтажные работы", "Проведение тендера для заключения договора с подрядчиком на выполнение работ", "01.07.2025", "30.11.2025", "", ""),
    ("Закупки", "Электромонтажные работы", "Заявка на материалы", "25.11.2025", "01.08.2026", "", ""),
    ("Закупки", "Электромонтажные работы", "Поставка материалов", "05.12.2025", "01.09.2026", "", ""),
    
    # Строительство - Электромонтажные работы
    ("Строительство", "Электромонтажные работы", "Электромонтажные работы", "21.03.2026", "20.04.2026", "", ""),
    
    # Строительство - Обратная засыпка
    ("Строительство", "Обратная засыпка", "Обратная засыпка", "10.03.2025", "20.03.2025", "10.03.2025", "20.03.2025"),
    
    # Тех. заказ - Монтаж металлических ограждений по фасаду
    ("Тех. заказ", "Монтаж металлических ограждений по фасаду", "Проверка РД и составление ЛЗВ", "19.09.2025", "23.09.2025", "27.10.2025", "10.11.2025"),
    
    # Закупки - Монтаж металлических ограждений по фасаду
    ("Закупки", "Монтаж металлических ограждений по фасаду", "Проведение тендера для заключения договора на изготовление поставку и монтаж ограждений", "10.11.2025", "30.11.2025", "", ""),
    
    # Строительство - Монтаж металлических ограждений по фасаду
    ("Строительство", "Монтаж металлических ограждений по фасаду", "Монтаж металлических ограждений по фасаду", "21.06.2025", "30.06.2025", "22.08.2025", "24.08.2025"),
    
    # Строительство - Монтаж оконных ограждений (внешние конструкции)
    ("Строительство", "Монтаж оконных ограждений (внешние конструкции)", "Монтаж ограждений лоджий", "10.06.2026", "10.08.2026", "", ""),
    
    # Тех. заказ - Монтаж оконных конструкций
    ("Тех. заказ", "Монтаж оконных конструкций", "Проверка РД и составление ЛЗВ", "09.07.2025", "22.07.2025", "15.07.2025", "22.07.2025"),
    
    # Закупки - Монтаж оконных конструкций
    ("Закупки", "Монтаж оконных конструкций", "Проведение тендера для заключения договора на изготовление окон, поставку и монтаж", "21.07.2025", "31.08.2025", "17.10.2025", ""),
    
    # Строительство - Монтаж оконных конструкций
    ("Строительство", "Монтаж оконных конструкций", "Монтаж оконных конструкций", "10.04.2026", "30.05.2026", "", ""),
    
    # Тех. заказ - Штукатурные работы
    ("Тех. заказ", "Штукатурные работы", "Проверка РД и составление ЛЗВ", "05.09.2025", "19.09.2025", "05.09.2025", "26.09.2025"),
    
    # Закупки - Штукатурные работы
    ("Закупки", "Штукатурные работы", "Проведение тендера для заключения договора с подрядчиком на выполнение работ", "24.02.2026", "31.03.2026", "", ""),
    ("Закупки", "Штукатурные работы", "Заявка на материалы", "15.03.2026", "15.06.2026", "", ""),
    ("Закупки", "Штукатурные работы", "Поставка материалов", "13.04.2026", "30.06.2026", "", ""),
    
    # Строительство - Штукатурные работы
    ("Строительство", "Штукатурные работы", "Штукатурные работы", "21.10.2025", "20.04.2026", "", ""),
    
    # Тех. заказ - Монтаж ОВ и ВК
    ("Тех. заказ", "Монтаж ОВ и ВК", "Передача РДа в тех. Заказ ОВ", "10.05.2025", "15.05.2025", "21.05.2025", "26.06.2025"),
    ("Тех. заказ", "Монтаж ОВ и ВК", "Передача РДа в тех. Заказ ВК", "10.05.2025", "15.05.2025", "13.05.2025", "26.06.2025"),
    ("Тех. заказ", "Монтаж ОВ и ВК", "Передача РД ГП", "13.06.2025", "16.06.2025", "13.05.2025", "17.07.2025"),
    ("Тех. заказ", "Монтаж ОВ и ВК", "Передача РД ГП", "29.06.2025", "30.06.2025", "21.05.2025", "29.05.2025"),
    ("Тех. заказ", "Монтаж ОВ и ВК", "Проверка РД и составление ЛЗВ", "03.07.2025", "24.07.2025", "03.07.2025", "28.07.2025"),
    ("Тех. заказ", "Монтаж ОВ и ВК", "Проверка РД и составление ЛЗВ", "25.07.2025", "08.08.2025", "25.07.2025", "11.08.2025"),
    
    # Закупки - Монтаж ОВ и ВК
    ("Закупки", "Монтаж ОВ и ВК", "Проведение тендера для заключения договора с подрядчиком на выполнение работ", "15.07.2025", "15.08.2025", "", ""),
    ("Закупки", "Монтаж ОВ и ВК", "Проведение тендера для заключения договора с подрядчиком на выполнение работ", "15.07.2025", "15.08.2025", "", ""),
    ("Закупки", "Монтаж ОВ и ВК", "Заявка на материалы", "20.08.2025", "01.07.2026", "", ""),
    ("Закупки", "Монтаж ОВ и ВК", "Заявка на материалы", "20.08.2025", "01.07.2026", "", ""),
    ("Закупки", "Монтаж ОВ и ВК", "Поставка материалов", "20.09.2025", "01.08.2026", "", ""),
    ("Закупки", "Монтаж ОВ и ВК", "Поставка материалов", "20.09.2025", "01.08.2026", "", ""),
    
    # Строительство - Монтаж ОВ и ВК
    ("Строительство", "Монтаж ОВ и ВК", "Монтаж ОВ и ВК", "01.05.2026", "30.06.2026", "", ""),
    
    # Тех. заказ - Наружный водопровод
    ("Тех. заказ", "Наружный водопровод", "Проверка РД и составление ЛЗВ", "15.09.2025", "19.09.2025", "10.10.2025", "16.10.2025"),
    
    # Закупки - Наружный водопровод
    ("Закупки", "Наружный водопровод", "Поставка материалов", "01.03.2026", "31.03.2026", "", ""),
    ("Закупки", "Наружный водопровод", "Проведение тендера для заключения договора с подрядчиком на выполнение работ", "10.05.2026", "20.05.2026", "", ""),
    ("Закупки", "Наружный водопровод", "Заявка на материалы", "15.06.2026", "25.06.2026", "", ""),
    
    # Закупки - Монтаж ИТП
    ("Закупки", "Монтаж ИТП", "Изготовление оборудования ИТП и поставка на площадку", "01.09.2025", "30.10.2025", "", "30.12.2025"),
    ("Закупки", "Монтаж ИТП", "Проведение тендера для заключения договора на монтаж ИТП", "01.11.2025", "30.11.2025", "", ""),
    ("Закупки", "Монтаж ИТП", "Получение проекта и соглосование проекта с СЗИП", "01.04.2026", "30.04.2026", "", ""),
    ("Закупки", "Монтаж ИТП", "Проведение тендера и заключение договора на проектирование", "20.04.2026", "20.08.2026", "", ""),
    
    # Тех. заказ - Монтаж насосной, ИТП, электрощитовой
    ("Тех. заказ", "Монтаж насосной, ИТП, электрощитовой", "Проверка РД и составление ЛЗВ", "12.09.2025", "20.10.2025", "01.07.2025", "02.07.2025"),
    
    # Строительство - Монтаж насосной, ИТП, электрощитовой
    ("Строительство", "Монтаж насосной, ИТП, электрощитовой", "Монтаж насосной, ИТП, электрощитовой", "01.08.2026", "20.10.2026", "", ""),
    
    # Тех. заказ - Монтаж подпорных стен
    ("Тех. заказ", "Монтаж подпорных стен", "передача РД в тех. Заказ - 1 этап", "17.03.2025", "25.03.2025", "17.03.2025", "25.03.2025"),
    ("Тех. заказ", "Монтаж подпорных стен", "Проверка РД и составление ЛЗВ", "17.03.2025", "25.04.2025", "17.03.2025", "25.04.2025"),
    ("Тех. заказ", "Монтаж подпорных стен", "передача РД в тех. Заказ - 2 этап", "26.03.2025", "20.04.2025", "", ""),
    
    # Закупки - Монтаж подпорных стен
    ("Закупки", "Монтаж подпорных стен", "Проведение тендера для заключения договора с подрядчиком на выполнение работ", "18.03.2025", "25.03.2025", "01.09.2025", "30.09.2025"),
    ("Закупки", "Монтаж подпорных стен", "Заявка на материалы", "19.03.2025", "15.05.2025", "01.09.2025", "15.05.2025"),
    ("Закупки", "Монтаж подпорных стен", "Поставка материалов", "25.03.2025", "10.06.2025", "10.09.2025", ""),
    
    # Тех. заказ - Теплотрасса от котельной к ж/д
    ("Тех. заказ", "Теплотрасса от котельной к ж/д", "Заявка материалы (ЛЗВ составлена и передана)", "26.05.2025", "31.05.2025", "26.05.2025", "31.05.2025"),
    
    # Закупки - Теплотрасса от котельной к ж/д
    ("Закупки", "Теплотрасса от котельной к ж/д", "Поставка материалов", "15.07.2025", "15.08.2025", "", ""),
    ("Закупки", "Теплотрасса от котельной к ж/д", "Проведение тендера для заключения договора с подрядчиком на выполнение работ", "20.04.2026", "30.04.2026", "", ""),
    ("Закупки", "Теплотрасса от котельной к ж/д", "Заявка на материалы", "15.05.2026", "01.06.2026", "", ""),
    
    # Строительство - Внутриплощадочные инженерные сети
    ("Строительство", "Внутриплощадочные инженерные сети", "Теплотрасса", "10.05.2026", "10.06.2026", "", ""),
    ("Строительство", "Внутриплощадочные инженерные сети", "Сети х/ф и ливневой канализации", "10.06.2026", "10.07.2026", "", ""),
    ("Строительство", "Внутриплощадочные инженерные сети", "Сети водопровода", "21.08.2026", "20.09.2026", "", ""),
    
    # Строительство - Внутриплощадочные электрические сети
    ("Строительство", "Внутриплощадочные электрические сети", "Внутриплощадочные электрические сети", "10.06.2026", "30.06.2026", "", ""),
    
    # Тех. заказ - Устройство стяжки пола
    ("Тех. заказ", "Устройство стяжки пола", "Проверка РД и составление ЛЗВ", "04.08.2025", "12.08.2025", "04.08.2025", "12.08.2025"),
    
    # Закупки - Устройство стяжки пола
    ("Закупки", "Устройство стяжки пола", "Проведение тендера для заключения договора с подрядчиком на выполнение работ", "16.03.2026", "20.04.2026", "", ""),
    ("Закупки", "Устройство стяжки пола", "Заявка на материалы (пленка, сетка, пенопласт)", "20.04.2026", "15.06.2026", "", ""),
    ("Закупки", "Устройство стяжки пола", "Поставка материалов (пленка, сетка, пенопласт)", "01.05.2026", "25.06.2026", "", ""),
    
    # Строительство - Устройство стяжки пола
    ("Строительство", "Устройство стяжки пола", "Устройство стяжки пола", "01.10.2025", "30.10.2026", "", ""),
    
    # Тех. заказ - Монтаж лестничных ограждений
    ("Тех. заказ", "Монтаж лестничных ограждений", "Проверка РД и составление ЛЗВ", "09.07.2025", "22.07.2025", "09.07.2025", "27.10.2025"),
    
    # Закупки - Монтаж лестничных ограждений
    ("Закупки", "Монтаж лестничных ограждений", "Проведение тендера для заключения договора на изготовление поставку и монтаж ограждений", "10.11.2025", "30.11.2025", "", ""),
    
    # Строительство - Монтаж лестничных ограждений
    ("Строительство", "Монтаж лестничных ограждений", "Монтаж лестничных ограждений", "21.04.2026", "10.07.2026", "", ""),
    
    # Тех. заказ - Отделочные работы
    ("Тех. заказ", "Отделочные работы", "Проверка РД и составление ЛЗВ (дизайн проект -24.11.2025)", "24.11.2025", "26.12.2025", "26.12.2025", ""),
    
    # Закупки - Отделочные работы
    ("Закупки", "Отделочные работы", "Проведение тендера для заключения договора с подрядчиком на выполнение работ", "12.05.2026", "30.06.2026", "", ""),
    ("Закупки", "Отделочные работы", "Заявка на материалы", "01.07.2026", "30.09.2026", "", ""),
    ("Закупки", "Отделочные работы", "Поставка материалов", "21.07.2026", "05.10.2026", "", ""),
    
    # Строительство - Отделочные работы
    ("Строительство", "Отделочные работы", "Отделочные работы", "01.03.2026", "20.04.2026", "", ""),
    ("Строительство", "Отделочные работы", "Отделка ИТП, электрощитовой, насосной", "21.05.2026", "31.07.2026", "", ""),
    
    # Строительство - Монтаж дверей
    ("Строительство", "Монтаж дверей", "Монтаж дверей", "10.06.2026", "30.08.2026", "", ""),
    
    # Тех. заказ - Монтаж лифтового оборудования
    ("Тех. заказ", "Монтаж лифтового оборудования", "Проверка РД и составление ЛЗВ (опросный лист)", "01.10.2025", "15.11.2025", "01.10.2025", "21.10.2025"),
    
    # Закупки - Монтаж лифтового оборудования
    ("Закупки", "Монтаж лифтового оборудования", "Проведение тендера для заключения договора на изготовление лифтов и поставку на площадку", "15.11.2025", "30.11.2025", "22.12.2025", "30.12.2025"),
    ("Закупки", "Монтаж лифтового оборудования", "Проведение тендера для заключения договора на монтаж лифтов", "17.11.2025", "19.12.2025", "", ""),
    ("Закупки", "Монтаж лифтового оборудования", "Изготовление лифтов и поставка на площадку", "30.11.2025", "20.05.2026", "", ""),
    
    # Строительство - Монтаж лифтового оборудования
    ("Строительство", "Монтаж лифтового оборудования", "Монтаж лифтового оборудования", "01.10.2025", "10.10.2026", "", ""),
    
    # Закупки - Монтаж МАФ
    ("Закупки", "Монтаж МАФ", "Проведение тендера для заключения договора на изготовление оборудования", "20.02.2026", "20.04.2026", "", ""),
    ("Закупки", "Монтаж МАФ", "Изготовление оборудования доставка на площадку", "20.04.2026", "20.06.2026", "", ""),
    
    # Строительство - Благоустройство
    ("Строительство", "Благоустройство", "Благоустройство", "01.07.2026", "10.07.2026", "", ""),
    
    # Строительство - Озеленение
    ("Строительство", "Озеленение", "Озеленение", "01.08.2026", "20.09.2026", "", ""),
    
    # Закупки - Ограждение территории
    ("Закупки", "Ограждение территории", "Проведение тендера для заключения договора с подрядчиком с материалом", "10.05.2026", "10.06.2026", "", ""),
    
    # Закупки - Домофон, интернет, слаботочные системы, пожаротушение
    ("Закупки", "Домофон, интернет, слаботочные системы, пожаротушение", "Проведение тендера для заключения договора с подрядчиком с материалом", "01.06.2026", "10.07.2026", "", ""),
    ("Закупки", "Домофон, интернет, слаботочные системы, пожаротушение", "Проведение тендера для заключения договора с подрядчиком с материалом", "02.08.2026", "02.09.2026", "", ""),
    
    # Строительство - Отделка цоколя
    ("Строительство", "Отделка цоколя", "Отделка цоколя", "01.07.2026", "10.07.2026", "", ""),
    
    # Строительство - Пожарная сигнализация
    ("Строительство", "Пожарная сигнализация", "Пожарная сигнализация", "21.07.2026", "30.10.2026", "", ""),
    
    # Строительство - Сети наружного освещения
    ("Строительство", "Сети наружного освещения", "Сети наружного освещения", "01.07.2026", "20.07.2026", "", ""),
    
    # Тех. заказ - Навигация
    ("Тех. заказ", "Навигация", "Составление ТЗ", "01.07.2026", "01.08.2026", "", ""),
    
    # Закупки - Навигация
    ("Закупки", "Навигация", "Проведение тендера для заключения договора с подрядчиком с материалом", "20.02.2026", "20.04.2026", "", ""),
    
    # Строительство - Навигация
    ("Строительство", "Навигация", "Навигация", "01.10.2026", "20.10.2026", "", ""),
    
    # Строительство - Пуск тепла
    ("Строительство", "Пуск тепла", "Пуск тепла", "01.07.2026", "31.07.2026", "", ""),
    
    # Строительство - Демонтаж и перебазировка башенных кранов
    ("Строительство", "Демонтаж и перебазировка башенных кранов", "Демонтаж и перебазировка башенных кранов", "01.09.2026", "30.09.2026", "", ""),
    
    # Строительство - Получение ЗОС и РНВ
    ("Строительство", "Получение ЗОС и РНВ", "Получение ЗОС и РНВ", "21.10.2026", "10.11.2026", "", ""),
    
    # Тех. заказ - Монтаж оборудования ПНС
    ("Тех. заказ", "Монтаж оборудования ПНС", "Проверка РД и составление ЛЗВ", "03.07.2025", "24.07.2025", "03.07.2025", "28.07.2025"),
    
    # Закупки - Монтаж оборудования ПНС
    ("Закупки", "Монтаж оборудования ПНС", "Поставка материалов", "01.07.2025", "31.07.2025", "", ""),
    ("Закупки", "Монтаж оборудования ПНС", "Проведение тендера для заключения договора с подрядчиком на выполнение работ", "15.03.2026", "21.03.2026", "", ""),
    ("Закупки", "Монтаж оборудования ПНС", "Заявка на материалы", "15.05.2026", "01.06.2026", "", ""),
    
    # Тех. заказ - Монтаж оборудования электрощитовой (ВРУ)
    ("Тех. заказ", "Монтаж оборудования электрощитовой (ВРУ)", "Проверка РД и составление ЛЗВ", "15.05.2025", "29.05.2025", "15.07.2025", "22.07.2025"),
    
    # Закупки - Монтаж оборудования электрощитовой (ВРУ)
    ("Закупки", "Монтаж оборудования электрощитовой (ВРУ)", "Заявка на материалы", "01.12.2025", "01.06.2026", "", ""),
    ("Закупки", "Монтаж оборудования электрощитовой (ВРУ)", "Проведение тендера для заключения договора с подрядчиком на выполнение работ", "01.03.2026", "10.03.2026", "", ""),
    ("Закупки", "Монтаж оборудования электрощитовой (ВРУ)", "Поставка материалов", "01.04.2026", "30.04.2026", "", ""),
    
    # Тех. заказ - Внутриплощадочные сети ливневой канализации
    ("Тех. заказ", "Внутриплощадочные сети ливневой канализации", "Проверка РД и составление ЛЗВ", "15.09.2025", "19.09.2025", "10.10.2025", "16.10.2025"),
]

def main():
    print("=" * 60)
    print("Заполнение данных для объекта 'Богучар 2'")
    print("=" * 60)
    
    # Получить или создать город
    city = get_or_create_city("Богучар 2")
    
    # Получить пользователя для creator_id (admin)
    admin_user = db.query(models.User).filter(models.User.role == "admin").first()
    if not admin_user:
        admin_user = db.query(models.User).first()
    
    creator_id = admin_user.id if admin_user else 1
    print(f"Используется creator_id: {creator_id}")
    
    # Счётчики
    added = 0
    skipped = 0
    errors = 0
    
    for row in data:
        service, stage, work_name, plan_start, plan_end, fact_start, fact_end = row
        
        schedule_type = SERVICE_MAPPING.get(service)
        if not schedule_type:
            print(f"[WARN] Unknown service: {service}")
            errors += 1
            continue
        
        planned_start = parse_date(plan_start)
        planned_end = parse_date(plan_end)
        actual_start = parse_date(fact_start)
        actual_end = parse_date(fact_end)
        
        if not planned_start or not planned_end:
            print(f"[WARN] Skip record without dates: {work_name}")
            skipped += 1
            continue
        
        # Создаём запись
        schedule = models.Schedule(
            schedule_type=schedule_type,
            city_id=city.id,
            creator_id=creator_id,
            construction_stage=stage,
            planned_start_date=planned_start,
            planned_end_date=planned_end,
            actual_start_date=actual_start,
            actual_end_date=actual_end,
            work_name=work_name if schedule_type in ["construction", "procurement"] else None,
            vacancy=work_name if schedule_type == "hr" else None,
            sections=work_name if schedule_type == "document" else None
        )
        
        db.add(schedule)
        added += 1
    
    # Сохраняем все изменения
    db.commit()
    
    print("=" * 60)
    print(f"[OK] Dobavleno zapisey: {added}")
    print(f"[SKIP] Propushcheno (bez dat): {skipped}")
    print(f"[ERR] Oshibok: {errors}")
    print("=" * 60)

if __name__ == "__main__":
    main()
    db.close()
